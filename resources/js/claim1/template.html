<div class="smodal">
    <vue-final-modal
      v-slot="{ close }"
      classes="smodal__container"
      content-class="smodal__content"
      v-model="state.showAssesmentModal"
    >
      <ModalMarkup title="Warning!!!" :text="state.self_assesment_message" @close="close" />
    </vue-final-modal>
    <vue-final-modal
      v-slot="{ close }"
      classes="smodal__container"
      content-class="smodal__content"
      v-model="state.showYearsInfoModal"
    >
      <ModalMarkup title="Warning!!!" :text="state.self_assesment_message" @close="close" />
    </vue-final-modal>
    <vue-final-modal
      v-slot="{ close }"
      classes="smodal__container"
      content-class="smodal__content"
      v-model="state.showNIModal"
    >
      <ModalMarkup title="Warning!!!" :text="state.self_assesment_message" @close="close" />
    </vue-final-modal>
    <div class="smodal__body">
      <div class="swizard">
        <ProgressBar :step="state.step" />
        <div class="swizard__step" v-if="state.step == 1">
          <div class="swizard__title">
            <p class="swizard__title__p text-center">
              Please enter your PPI Claim details
            </p>
            <hr class="swizard__title__line" />
          </div>
          <div class="swizard__radio">
            <p>
              Were you required to complete a Self-Assessment the year you got
              your PPI refund?
            </p>
            <div class="swizard__radio__items">
              <div class="swizard__radio__items__item">
                <input
                  id="self_assesment_yes"
                  type="radio"
                  v-model="state.form[0].self_assesment"
                  name="self_assesment"
                  :value="true"
                  @click="state.showAssesmentModal = true"
                />
                <label for="self_assesment_yes"><span>Yes </span></label>
              </div>
              <div class="swizard__radio__items__item">
                <input
                  id="self_assesment_no"
                  type="radio"
                  v-model="state.form[0].self_assesment"
                  name="self_assesment"
                  :value="false"
                />
                <label for="self_assesment_no">No</label>
              </div>
            </div>
            <HasError field="self_assesment" :errors="state.errors" />
          </div>
          <div class="swizard__title">
            <p class="swizard__title__p">
              Please provide us with the TOTAL amount you received for your PPI
              refunds in the relevant tax years below
            </p>
          </div>
          <div class="swizard__years">
            <div class="swizard__years__items">
              <p>Apr 2018 - Mar 2019</p>
              <div class="swizard__years__items__item">
                <span class="swizard__years__items__item__left-icon">£</span>
                <input
                  type="number"
                  v-model="state.form[0].year_1"
                  class="swizard__years__items__item__box hide-arrows"
                />
                <span class="swizard__years__items__item__right-icon" @click="state.showYearsInfoModal = true"
                  ><IconInfo
                /></span>
              </div>
            </div>
            <div class="swizard__years__items">
              <p>Apr 2019 - Mar 2020</p>
              <div class="swizard__years__items__item">
                <span class="swizard__years__items__item__left-icon">£</span>
                <input
                  type="number"
                  v-model="state.form[0].year_2"
                  class="swizard__years__items__item__box hide-arrows"
                />
                <span class="swizard__years__items__item__right-icon" @click="state.showYearsInfoModal = true"
                  ><IconInfo
                /></span>
              </div>
            </div>
            <div class="swizard__years__items">
              <p>Apr 2020 - Mar 2021</p>
              <div class="swizard__years__items__item">
                <span class="swizard__years__items__item__left-icon">£</span>
                <input
                  type="number"
                  v-model="state.form[0].year_3"
                  class="swizard__years__items__item__box hide-arrows"
                />
                <span class="swizard__years__items__item__right-icon" @click="state.showYearsInfoModal = true"
                  ><IconInfo
                /></span>
              </div>
            </div>
            <div class="swizard__years__items">
              <p>Apr 2021 - Mar 2022</p>
              <div class="swizard__years__items__item">
                <span class="swizard__years__items__item__left-icon">£</span>
                <input
                  type="number"
                  v-model="state.form[0].year_4"
                  class="swizard__years__items__item__box hide-arrows"
                />
                <span class="swizard__years__items__item__right-icon" @click="state.showYearsInfoModal = true"
                  ><IconInfo
                /></span>
              </div>
            </div>

            <HasError
              field="year"
              :errors="state.errors"
              message="Please fill at least one record"
            />
          </div>
          <div class="swizard__radio">
            <p>
              Were you earning less than £50,000.00 a year at the time you
              received your PPI refund?
            </p>
            <div class="swizard__radio__items">
              <div class="swizard__radio__items__item">
                <input
                  id="less_earning"
                  type="radio"
                  name="less_earning"
                  :value="true"
                  v-model="state.form[0].less_earning"
                />
                <label for="less_earning">Yes</label>
              </div>
              <div class="swizard__radio__items__item">
                <input
                  id="more_earning"
                  type="radio"
                  name="less_earning"
                  :value="false"
                  v-model="state.form[0].less_earning"
                />
                <label for="more_earning">No</label>
              </div>
            </div>
            <HasError field="less_earning" :errors="state.errors" />
          </div>
          <div class="swizard__input">
            <p>National insurance (NI) Number</p>
            <div class="swizard__input__item">
              <input
                type="text"
                v-model="state.form[0].ni_number"
                class="swizard__input__item__box"
              />
              <span
                class="swizard__input__item__right-icon ni-number"
                @click="state.showNIModal = true"
                ><IconInfo
              /></span>
            </div>
          </div>
          <div class="swizard__sign__checkbox">
            <input
              id="cant_remember"
              type="checkbox"
              :value="true"
              v-model="state.form[0].cant_remember"
            />
            <label for="cant_remember"
              >Can't remember (Provide it later)
            </label>
          </div>
          <HasError field="ni_number" :errors="state.errors" />

          <div class="swizard__submit" v-if="!state.form[0].self_assesment">
              <button
              type="button"
              class="sbutton sbutton__primary sbutton--active"
              @click="stepForward"
              >
              Continue <span class="sbutton__primary__icon"><IconNext /></span>
            </button>
        </div>
        <HasError v-else style="text-align: center;" field="already_assessed" :errors="['already_assessed']" :message="state.self_assesment_message" />
        </div>
        <div class="swizard__step" v-if="state.step == 2">
          <div class="swizard__title">
            <p class="swizard__title__p text-center">
              Please complete your details below to start your claim
            </p>
            <hr class="swizard__title__line" />
          </div>
          <div class="swizard__about">
            <div class="swizard__input swizard__about__item">
              <p>Title</p>
              <div class="swizard__input__item">
                <select
                  v-model="state.form[1].title"
                  class="swizard__input__item__box"
                >
                  <option :value="null">Select</option>
                  <option value="Nr.">Mr.</option>
                  <option value="Mrs.">Mrs.</option>
                </select>
                <span class="swizard__input__item__right-icon"
                  ><IconSelect
                /></span>
              </div>
            </div>
            <div class="swizard__input swizard__about__item">
              <p>First Name</p>
              <div class="swizard__input__item">
                <input
                  v-model="state.form[1].first_name"
                  class="swizard__input__item__box"
                />
              </div>
            </div>
            <div class="swizard__input swizard__about__item">
              <p>Last Name</p>
              <div class="swizard__input__item">
                <input
                  v-model="state.form[1].last_name"
                  class="swizard__input__item__box"
                />
              </div>
            </div>
          </div>
          <HasError
            field="name"
            :errors="state.errors"
            message="The above fields are required"
          />

          <p>DOB</p>
          <div class="swizard__about">
            <div class="swizard__input swizard__about__item">
              <div class="swizard__input__item">
                <select
                  v-model="state.form[1].day"
                  class="swizard__input__item__box"
                >
                  <option :value="null">Day</option>
                  <option :value="v" :key="v" v-for="v in 31">{{ v }}</option>
                </select>
                <span class="swizard__input__item__right-icon"
                  ><IconSelect
                /></span>
              </div>
            </div>
            <div class="swizard__input swizard__about__item">
              <div class="swizard__input__item">
                <select
                  v-model="state.form[1].month"
                  class="swizard__input__item__box"
                >
                  <option :value="null">Month</option>
                  <option :value="v" :key="v" v-for="v in 12">{{ v }}</option>
                </select>
                <span class="swizard__input__item__right-icon"
                  ><IconSelect
                /></span>
              </div>
            </div>
            <div class="swizard__input swizard__about__item">
              <div class="swizard__input__item">
                <select
                  v-model="state.form[1].year"
                  class="swizard__input__item__box"
                >
                  <option :value="null">Year</option>
                  <option
                    :value="new Date().getFullYear() - v + 1"
                    :key="v"
                    v-for="v in 101"
                  >
                    {{ new Date().getFullYear() - v + 1 }}
                  </option>
                </select>
                <span class="swizard__input__item__right-icon"
                  ><IconSelect
                /></span>
              </div>
            </div>
          </div>
          <HasError
            field="dob"
            :errors="state.errors"
            message="The above fields are required"
          />

          <div class="swizard__submit">
            <button
              type="button"
              class="sbutton sbutton__primary sbutton--active"
              @click="stepForward"
            >
              Continue <span class="sbutton__primary__icon"><IconNext /></span>
            </button>
            <button
              type="button"
              @click="stepBack"
              class="sbutton sbutton__back"
            >
              <span class="sbutton__primary__back"><IconPrevious /></span>Back
            </button>
          </div>
        </div>
        <div class="swizard__step" v-if="state.step == 3">
          <div class="swizard__title">
            <p class="swizard__title__p text-center">
              Enter your contact details to claim your tax back
            </p>
            <hr class="swizard__title__line" />
          </div>
          <div class="swizard__input">
            <p>Email</p>
            <div class="swizard__input__item">
              <input
                type="text"
                v-model="state.form[2].email"
                class="swizard__input__item__box"
              />
            </div>
            <HasError field="email" :errors="state.errors" />
          </div>
          <div class="swizard__input">
            <p>Phone Number</p>
            <div class="swizard__input__item">
              <input
                type="text"
                v-model="state.form[2].phone"
                class="swizard__input__item__box"
              />
            </div>
            <HasError field="phone" :errors="state.errors" />
          </div>
          <div class="swizard__input">
            <p>Address</p>
            <div class="swizard__input__item">
              <input
                type="text"
                v-model="state.form[2].address"
                class="swizard__input__item__box"
              />
            </div>
            <HasError field="address" :errors="state.errors" />
          </div>
          <div class="swizard__input">
            <p>Postcode</p>
            <div class="swizard__input__item">
              <input
                type="text"
                v-model="state.form[2].postcode"
                class="swizard__input__item__box"
              />
            </div>
            <HasError field="postcode" :errors="state.errors" />
          </div>
          <div class="swizard__sign__checkbox">
            <input
              id="agreed"
              type="checkbox"
              :value="1"
              v-model="state.form[2].agree"
            />
            <label for="agreed"
              ><small
                >I agree for Reclaim My PPI Tax to contact me with regards to
                any tax rebate purposes.</small
              >
            </label>
          </div>
          <HasError field="agree" :errors="state.errors" />

          <div class="swizard__submit">
            <button
              type="button"
              class="sbutton sbutton__primary sbutton--active"
              @click="stepForward"
            >
              Continue <span class="sbutton__primary__icon"><IconNext /></span>
            </button>
            <button
              type="button"
              @click="stepBack"
              class="sbutton sbutton__back"
            >
              <span class="sbutton__primary__back"><IconPrevious /></span> Back
            </button>
          </div>
        </div>
        <div class="swizard__step" v-if="state.step == 4">
          <div class="swizard__claim swizard__title">
            <h3>Great News!</h3>
            <p class="swizard__claim__congrat">
              <span class="swizard__claim__success">Congratulations, </span> You
              100% meet the criteria
            </p>
            <p class="swizard__claim__time">
              Our customers get money back in 6 Weeks!
            </p>
            <hr class="swizard__title__line" />
          </div>
          <div class="swizard__claim__message">
            <p>
              Signing below agrees you into our
              <span class="swizard__claim__message__terms"
                >terms and conditions</span
              >
              and our NO WIN NO FEE services.
            </p>
          </div>
          <div class="swizard__input">
            <p>Do you have a referral code? (optional)</p>
            <div class="swizard__input__item">
              <input
                v-model="state.form[3].referal_code"
                class="swizard__input__item__box"
              />
            </div>
          </div>
          <div class="swizard__input">
            <p>Please draw your signature below in the green box.</p>
            <div class="swizard__input__item">
              <VueSignaturePad
                width="100%"
                height="200px"
                style="border: 1px solid green; background-color: white"
                ref="signaturePad"
              />
              <HasError
                field="signature"
                :errors="state.errors"
                message="Signature required"
              />
            </div>
          </div>
          <small style="cursor: pointer" @click="clearSignature"
            >Clear Signature</small
          >
          <div class="swizard__submit">
            <button
              type="button"
              class="sbutton sbutton__primary sbutton--active"
              @click="submit"
            >
              Start Your Claim
            </button>
            <button
              type="button"
              @click="stepBack"
              class="sbutton sbutton__back"
            >
              <span class="sbutton__primary__back"><IconPrevious /></span> Back
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
